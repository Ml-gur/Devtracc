import{v as b,a as r,s as y,j as e,A as C,h as v,B as d,o as w}from"./index-RP35jY-7.js";import{C as k,a as R,b as E,d as S,c as T}from"./card-01_Ovl9v.js";import{B as A}from"./badge-vvYGiQt7.js";import{M as p}from"./mail-BM6AhEgu.js";import{C as _,A as D}from"./clock-D4aNAG4B.js";import{C as B}from"./circle-check-big-Ml8rsUmQ.js";function z({email:o,onNavigate:a,onResendConfirmation:F}){const{resendConfirmation:j}=b(),[m,x]=r.useState(!1),[c,n]=r.useState(null),[l,u]=r.useState(60),[f,h]=r.useState(!1);r.useEffect(()=>{if(l>0){const s=setTimeout(()=>{u(l-1)},1e3);return()=>clearTimeout(s)}else h(!0)},[l]),r.useEffect(()=>{const{data:{subscription:s}}=y.auth.onAuthStateChange((i,t)=>{console.log("ðŸ“§ Email confirmation page auth change:",{event:i,hasSession:!!t,userConfirmed:t?.user?.email_confirmed_at}),i==="SIGNED_IN"&&t&&t.user.email_confirmed_at?(console.log("âœ… Email confirmed successfully, redirecting to dashboard"),a("dashboard")):i==="TOKEN_REFRESHED"&&t&&t.user.email_confirmed_at&&(console.log("âœ… Token refreshed with confirmed email, redirecting to dashboard"),a("dashboard"))});return()=>s.unsubscribe()},[a]);const g=async()=>{x(!0),n(null);try{const s=await j(o);s.success?(n({type:"success",text:s.message||"Confirmation email sent successfully!"}),u(60),h(!1)):n({type:"error",text:s.error||"Failed to resend confirmation email"})}catch{n({type:"error",text:"An unexpected error occurred"})}finally{x(!1)}},N=s=>{const i=Math.floor(s/60),t=s%60;return`${i}:${t.toString().padStart(2,"0")}`};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-lg",children:"DT"})}),e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"DevTrack Africa"})]}),e.jsx(A,{variant:"outline",className:"px-3 py-1",children:"Email Confirmation Required"})]}),e.jsxs(k,{className:"border-0 shadow-xl",children:[e.jsxs(R,{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-8 h-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(E,{className:"text-xl mb-2",children:"Check Your Email"}),e.jsx(S,{className:"text-base",children:"We've sent a confirmation link to:"}),e.jsx("div",{className:"mt-2 p-2 bg-muted rounded-lg",children:e.jsx("span",{className:"font-medium text-foreground",children:o})})]})]}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mt-0.5",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Check your inbox"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Look for an email from DevTrack Africa"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold mt-0.5",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Click the confirmation link"}),e.jsx("p",{className:"text-sm text-green-700",children:"This will verify your email and sign you in"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold mt-0.5",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-purple-900",children:"Complete your profile"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Add your developer details to get started"})]})]})]}),c&&e.jsx(C,{variant:c.type==="error"?"destructive":"default",children:e.jsx(v,{children:c.text})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{onClick:g,disabled:!f||m,className:"w-full",variant:"outline",children:m?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):f?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Resend Confirmation Email"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Resend in ",N(l)]})}),e.jsxs(d,{onClick:()=>a("login"),variant:"ghost",className:"w-full",children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Can't find the email? Check your spam folder."}),e.jsxs("p",{className:"mt-1",children:["Need help?"," ",e.jsx(d,{variant:"link",size:"sm",className:"h-auto p-0 text-sm",onClick:()=>a("welcome"),children:"Contact Support"})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(B,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"This page will automatically redirect when your email is confirmed"})]})})]})})}export{z as default};
