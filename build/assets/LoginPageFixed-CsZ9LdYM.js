import{v as M,a as n,j as e,B as m,A as p,h as f}from"./index-RP35jY-7.js";import{L as k,I as C}from"./label-BYT-7mqS.js";import{C as B,a as W,b as q,d as O,c as $}from"./card-01_Ovl9v.js";import{C as H}from"./circle-alert-D7yo-Vxo.js";import{M as Q}from"./mail-BM6AhEgu.js";function K({onBack:j,onSuccess:g,onNeedConfirmation:P,onNavigateToRegister:S}){const{signIn:D,resetPassword:E,signInAsTestUser:F}=M(),[i,A]=n.useState({email:"",password:""}),[a,t]=n.useState({}),[l,d]=n.useState(!1),[b,v]=n.useState(!1),[u,y]=n.useState(""),[x,o]=n.useState(""),[N,h]=n.useState(!1),I=()=>{const s={},r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return i.email?r.test(i.email)||(s.email="Please enter a valid email address"):s.email="Email is required",i.password||(s.password="Password is required"),t(s),Object.keys(s).length===0},w=(s,r)=>{A(c=>({...c,[s]:r})),a[s]&&t(c=>({...c,[s]:void 0})),a.general&&t(c=>({...c,general:void 0})),N&&h(!1)},L=async s=>{if(s.preventDefault(),!!I()){d(!0),t({}),h(!1);try{const r=await D(i.email,i.password);r.success?g():r.error?.includes("Email not confirmed")||r.error?.includes("verify your email")?(h(!0),P(i.email)):r.error&&t({general:r.error})}catch{t({general:"Login failed. Please try again."})}finally{d(!1)}}},R=async()=>{if(!u){alert("Please enter your email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){alert("Please enter a valid email address");return}v(!0);try{const r=await E(u);r.success?o("Password reset email sent! Check your inbox."):o(r.error||"Failed to send reset email")}catch{o("Failed to send reset email. Please try again.")}setTimeout(()=>{v(!1),o(""),y("")},5e3)},T=a.general&&(a.general.includes("Invalid email or password")||a.general.includes("Invalid login credentials")||a.general.includes("No account found"));return e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-muted/20",children:[e.jsxs(m,{variant:"ghost",onClick:j,className:"absolute top-4 left-4 flex items-center gap-2",disabled:l,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),e.jsxs(B,{className:"w-full max-w-md",children:[e.jsxs(W,{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold",children:"DT"})}),e.jsx("span",{className:"text-xl font-bold",children:"DevTrack"})]}),e.jsx(q,{children:"Welcome Back"}),e.jsx(O,{children:"Sign in to continue your development journey"})]}),e.jsx($,{children:N?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 text-orange-600"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"Email Confirmation Required"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your account needs to be verified before you can sign in."})]}),e.jsxs(p,{className:"border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx(f,{className:"text-blue-800 dark:text-blue-200",children:"We're redirecting you to check your email and confirm your account."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{onClick:j,variant:"outline",className:"w-full",children:"Back to Welcome"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Don't see the confirmation email? Check your spam folder or try registering again."})]})]}):e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[a.general&&e.jsx(p,{variant:"destructive",children:e.jsxs(f,{children:[a.general,T&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border-l-4 border-blue-400",children:e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"ðŸ’¡ Quick Solutions:"}),e.jsxs("ul",{className:"mt-1 ml-4 list-disc space-y-1",children:[e.jsx("li",{children:"Try the demo access button below"}),e.jsx("li",{children:'Create a new account using "Sign up here" link'}),e.jsx("li",{children:"Double-check your email spelling and password"}),e.jsx("li",{children:"Make sure your account is verified"})]})]})})]})}),x&&e.jsx(p,{variant:x.includes("sent")?"default":"destructive",children:e.jsx(f,{children:x})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"email",children:"Email Address"}),e.jsx(C,{id:"email",type:"email",placeholder:"Enter your email",value:i.email,onChange:s=>{w("email",s.target.value),y(s.target.value)},className:a.email?"border-destructive":"",autoComplete:"email",disabled:l}),a.email&&e.jsx("p",{className:"text-sm text-destructive",children:a.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"password",children:"Password"}),e.jsx(C,{id:"password",type:"password",placeholder:"Enter your password",value:i.password,onChange:s=>w("password",s.target.value),className:a.password?"border-destructive":"",autoComplete:"current-password",disabled:l}),a.password&&e.jsx("p",{className:"text-sm text-destructive",children:a.password})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:R,disabled:b||l,className:"text-sm text-primary hover:underline disabled:opacity-50",children:b?"Sending reset email...":"Forgot Password?"})}),e.jsx(m,{type:"submit",className:"w-full",disabled:l,children:l?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):"Sign In"}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Or try demo"})})]})}),e.jsx(m,{type:"button",variant:"outline",className:"w-full",disabled:l,onClick:async()=>{d(!0),t({});try{const s=await F();s.success?(console.log("ðŸŽ­ Demo user signed in successfully"),g()):t({general:s.error||"Demo access failed. Please try creating an account."})}catch{t({general:"Demo access failed. Please try creating an account."})}finally{d(!1)}},children:l?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Accessing demo..."})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"ðŸŽ­"}),e.jsx("span",{children:"Try Demo Dashboard"})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>S?.(),className:"text-primary hover:underline font-medium",disabled:l,children:"Sign up here"})]})})]})})]})]})}export{K as default};
